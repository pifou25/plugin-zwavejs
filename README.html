<h1>Plugin Zwave-Js</h1>

<p><img src="docs/images/jeedom.png" alt="Logo Jeedom" title="" />
<img src="docs/images/zwavejs.png" alt="Logo Plugin" title="" /></p>

<p>Version améliorée du plugin officiel <a href="https://github.com/jeedom/plugin-zwavejs">zwavejs</a></p>

<h2>Mode local</h2>

<p>Attention l'installation des dépendances n'installe plus le deamon local, il faut utiliser le bouton <code>ìnstaller ZwaveJS</code>. 
<br>La version <code>zwave-js-ui</code> qui sera installée et le préfixe MQTT par défaut se trouvent dans le fichier <code>core/config/zwavejs.config.ini</code>
<br>L'avancement de l'installation se trouve dans la log <code>zwavejs_packages</code>. Le voyant doit être vert et à OK et la version doit s'afficher en dessous une fois l'installation terminée.</p>

<p><img src="docs/images/zwavejs1.png" alt="Page configuration local" title="" /></p>

<p><p>
Pour plus d'infos voir la <a href="https://doc.jeedom.com/fr_FR/plugins/automation%20protocol/zwavejs">doc</a> du plugin ZWaveJS</p>

<h2>Mode remote docker (non managé)</h2>

<h3>Installation de l'image</h3>

<p>Installer l'image <code>zwave-js-ui</code> sur le docker distant:</p>

<pre><code>$ sudo docker pull zwavejs/zwave-js-ui
</code></pre>

<p>Copier et extraire l'archive générée <code>data/store/remote/docker_config.tar.gz</code> dans un répertoire local sur la machine distante ex:</p>

<pre><code>$ sudo mkdir -p /root/store/zwavejs
$ cd /root/store/zwavejs
$ sudo tar xvfz /tmp/docker_config.tar.gz
</code></pre>

<p><p>
Vous devez obtenir l'arborescence suivante:</p>

<pre><code>/root/store/zwavejs/config.json
/root/store/zwavejs/config/
</code></pre>

<h3>Démarrage et arrêt du container</h3>

<p><p>Copier et utiliser le script <code>resources/zwavejs</code> sur la machine distante pour gérer le container:</p>

<pre><code>$ sudo zwavejs 
usage: zwavejs {start|stop|restart|status}
</code></pre>

<p>Si vous utilisez un répertoire local différent de <code>/root/store/zwavejs</code> modifiez le dans le script
<br>Idem pour le device, par exemple: <code>/dev/ttyACM0</code></p>

<h3>Vérification du container</h3>

<p>Connectez-vous sur <code>http://remote-ip:8091</code></p>

<ul>
<li>Login: admin</li>
<li>Password: zwave</li>
</ul>

<p>Au bout de quelques secondes le driver doit passer à <code>Connected</code> (icône rond vert) et le statut à <code>Scan completed</code> </p>

<p><img src="docs/images/zwavejs2.png" alt="Admin zwave-js-ui" title="" /></p>

<h3>Paramètrage du plugin:</h3>

<p>Page de configuration du plugin:</p>

<ul>
<li>IP du container distant</li>
<li>Port d'administration du container (défaut 8091)</li>
<li>Préfixe MQTT (défaut zwave)</li>
<li>Communication container <code>ZWaveJS UI</code> et bouton <code>Tester</code>: vert si le container est démarré et disponible</li>
<li>Version ZWaveJS UI: version de l'image</li>
</ul>

<p>Vérifiez la communication en cliquant sur le bouton <code>Tester</code> 
<br>Le voyant <code>communication</code> doit passer au vert:</p>

<p><img src="docs/images/zwavejs3.png" alt="Page configuration remote" title="" /></p>

<p><br>Note: La version se mettra à jour après démarrage du deamon</p>

<h3>Démarrage du deamon</h3>

<p><br>Vous pouvez maintenant démarrer votre deamon Jeedom puis vérifier que les infos remontent:</p>

<p><img src="docs/images/zwavejs4.png" alt="Ecran principal" title="" /></p>

<h2>ChangeLog</h2>

<ul>
<li>v0.4 <a href="https://github.com/lxrootard">lxrootard</a>
<br> - Gestion de l'installation des dépendances en local ou en remote
<br> - Ajout de filtres sur les colonnes des équipements</li>
<li>v0.3 <a href="https://github.com/lxrootard">lxrootard</a>
<br> - Bugfix génération de l'archive et version de la librairie</li>
<li>v0.2 <a href="https://github.com/lxrootard">lxrootard</a>
<br> - Bugfix</li>
<li>v0.1 <a href="https://github.com/lxrootard">lxrootard</a>
<br> - Version initiale</li>
</ul>
